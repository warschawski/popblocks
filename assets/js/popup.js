(()=>{function x(t){return typeof t}function E(t){return Object.prototype.toString.call(t)}function q(t){return se(t)||t===!1||t===null}function I(t){return x(t)==="function"}function T(t){return x(t)==="object"}function se(t){return x(t)==="undefined"}function g(...t){let e={},i=!1,o=0;x(t[0])==="boolean"&&(i=t[0],o++);let n=a=>{for(let p in a)Object.hasOwn(a,p)&&(i&&E(a[p])==="[object Object]"?e[p]=g(e[p],a[p]):e[p]=a[p])};for(;o<t.length;o++)n(t[o]);return e}function k(t,e){return(e||document).querySelectorAll(t)}function B(t){return[...t.parentElement.children].filter(e=>e!=t)}function ne(t){return["[object NodeList]","[object Array]"].includes(E(t))||(t=[t]),[...t].filter(e=>!q(e))}function f(t,e){ne(t).forEach(e)}function v(t,e,i,o){f(t,n=>{n.addEventListener(e,i,o||null)})}function J(t,e,i,o){v(t,e,i,g({once:!0,capture:o===!0},T(o)?o:{}))}function C(t,e,i){f(t,o=>{o.removeEventListener(e,i)})}function F(t,e,i){f(t,o=>{o.dispatchEvent(new CustomEvent(e,{detail:i||null}))})}function z(...t){return E(t[0])==="[object Array]"&&(t=t[0]),t=t.filter(e=>e!==""),t}function H(t,e){return t.classList.contains(e)}function j(t,...e){e=z(...e),f(t,i=>{i.classList.add(...e)})}function _(t,...e){e=z(...e),f(t,i=>{i.classList.remove(...e)})}function re(t,e){return t.getAttribute(e)}function ae(t,e){if(E(t)!=="[object Object]"){let i={};i[`${t}`]=e,t=i}return Object.entries(t)}function G(t,e,i){e=ae(e,i),f(t,o=>{for(let[n,a]of e)q(a)?ce(t,n):o.setAttribute(n,a)})}function ce(t,e){E(e)!=="[object Array]"&&(e=[e]),f(t,i=>{f(e,o=>{i.removeAttribute(o)})})}function R(t,e,i,o){let n=V([o,e].join("-"));f(t,a=>{a.dataset[n]=re(a,e)||"",G(a,e,i)})}function U(t,e,i){let o=V([i,e].join("-"));f(t,n=>{G(n,e,n.dataset[o]||!1),delete n.dataset[o]})}function V(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,i)=>i.toUpperCase())}var O,D=class t{static#e=1;static#t={customClass:"",returnFocus:!0,templates:{container:`
<div class="popblocks-modal" role="dialog" aria-modal="true">
  <div class="popblocks-modal-overlay"></div>
  <div class="popblocks-modal-container">
    <div class="popblocks-modal-wrap">
      <button type="button" class="popblocks-modal-close" aria-label="Close">[close]</button>
      <div class="popblocks-modal-frame"></div>
    </div>
  </div>
</div>`,close:'<span class="popblocks-modal-sr">Close</span><svg viewBox="-6 -6 24 24" fill="currentColor"><path d="M7.314 5.9l3.535-3.536A1 1 0 1 0 9.435.95L5.899 4.485 2.364.95A1 1 0 1 0 .95 2.364l3.535 3.535L.95 9.435a1 1 0 1 0 1.414 1.414l3.535-3.535 3.536 3.535a1 1 0 1 0 1.414-1.414L7.314 5.899z"></path></svg>'}};static defaults(e){this.#t=g(!0,this.#t,e)}static construct(e,i){let o=k(e);return f(o,n=>{n.Modal||new t(n,i)}),o}constructor(e,i){if(e.Modal){console.warn("Modal: Instance already exists",e);return}let o={},n=e.dataset;try{o=JSON.parse(n.popblocksOptions||"{}")}catch{console.warn("Modal: Error parsing options JSON",e)}Object.assign(this,g(!0,this.constructor.#t,i||{},o)),this.el=e,this.guid=this.constructor.#e++,this.guidClass=`popblocks-modal-element-${this.guid}`,this.isOpen=!1,j(this.el,this.guidClass),v(this.el,"click",this.#o),e.Modal=this}destroy(){this.close(),_(this.el,this.guidClass),C(this.el,"click",this.#o),this.el.Modal=null,delete this.el.Modal}open(){if(this.isOpen)return;let e;O?e=O.close():e=new Promise((i,o)=>{i(this.el)}),e.then(()=>{this.hash=this.el.hash,this.targetEl=k(this.hash)[0],this.targetEl&&(this.listeners={close:this.#a(),container:this.#n(),keydown:this.#c()},this.#i(),this.#l(),setTimeout(()=>{j(this.modalEl,"popblocks-modal-open"),this.isOpen=!0,this.closeEl.focus(),O=this,F(window,"modal:open",{el:this.el})},10))})}close(){return this.isOpen?(_(this.modalEl,"popblocks-modal-open"),this.#s(),C(window,"keydown",this.listeners.keydown),C(window,"modal:close",this.listeners.close),new Promise((i,o)=>{let n=a=>{H(a.target,"popblocks-modal")&&(this.targetEl.append(...this.frameEl.childNodes),C(this.modalEl,"transitionend",n),this.modalEl.remove(),this.isOpen=!1,this.returnFocus&&this.el.focus(),F(window,"modal:close",{el:this.el}),O=null,i(this.el))};v(this.modalEl,"transitionend",n)})):void 0}#i(){let e=this.templates.container.replace("[close]",this.templates.close);document.body.insertAdjacentHTML("beforeend",e),this.modalEl=k(".popblocks-modal")[0],this.overlayEl=k(".popblocks-modal-overlay",this.modalEl)[0],this.closeEl=k(".popblocks-modal-close",this.modalEl)[0],this.containerEl=k(".popblocks-modal-container",this.modalEl)[0],this.wrapEl=k(".popblocks-modal-wrap",this.modalEl)[0],this.frameEl=k(".popblocks-modal-frame",this.modalEl)[0],this.frameEl.append(...this.targetEl.childNodes),this.wrapEl.append(this.frameEl),j(this.modalEl,this.customClass),J(this.closeEl,"click",this.listeners.close),v(this.containerEl,"click",this.listeners.container),v(window,"keydown",this.listeners.keydown),v(window,"modal:close",this.listeners.close)}#l(){R(B(this.modalEl),"aria-hidden","true","modal")}#s(){U(B(this.modalEl),"aria-hidden","modal")}#o(e){e.preventDefault(),e.stopPropagation(),this.Modal.open()}#n(){return e=>{e.target!==this.frameEl&&!this.frameEl.contains(e.target)?this.close():this.#r(e)}}#r(e){H(e.target,"popblocks-modal-trigger-close")&&this.close()}#a(){return e=>{this.close()}}#c(){return e=>{e.key==="Escape"&&this.close()}}},N=D;function W(t,e){typeof jQuery<"u"&&(jQuery.fn[e.toLowerCase()]=function(i,...o){return jQuery(this).each((n,a)=>{!i||T(i)?new t(a,i):a[e]&&I(a[e][i])&&a[e][i](...o)})})}function P(t,e){typeof jQuery<"u"&&(jQuery[e.toLowerCase()]=function(i,...o){if(I(t[i]))return t[i](...o)})}W(N,"Modal");P(N,"Modal");var Q=class{static#e={domain:null,expires:6048e5,path:null,samesite:"Lax",secure:null};static defaults(e){this.#e=g(!0,this.#e,e)}static set(e,i,o){let n=!1,a=new Date;o=g(!0,this.#e,o||{}),x(o.expires)==="number"&&(a.setTime(a.getTime()+o.expires),n=a.toGMTString());let p=o.domain?"; domain="+o.domain:"",A=n?"; expires="+n:"",w=n?"; max-age="+o.expires/1e3:"",L=o.path?"; path="+o.path:"",y=o.samesite?"; samesite="+o.samesite:"",h=o.secure?"; secure":"";document.cookie=`${e}=${i}${A}${w}${p}${L}${y}${h}`}static get(e){let i=`${e}=`,o=document.cookie.split(";");for(var n=0;n<o.length;n++){let a=o[n].trim();if(a.indexOf(i)===0)return a.substring(i.length,a.length)}return null}static delete(e,i){this.set(e,"",g({},i,{expires:-6048e5}))}},Y=Q;P(Y,"Cookie");(function(t,e){let i=navigator.language.split("-")[0];if(!navigator.geolocation)return;let o=null,n=e.sessionStorage.getItem("user-community-spotlight"),a=t.cookie("get","user-geo");try{n=JSON.parse(e.atob(n))}catch{}try{o=JSON.parse(a)}catch{}o?console.log(o):(console.log("Popblocks: Get Geo"),navigator.geolocation.getCurrentPosition(p));function p(l){console.log(l);let s={lat:l.coords.latitude,lng:l.coords.longitude};t.cookie("set","user-geo",JSON.stringify(s),{path:"/",expires:1e3*60*60*24})}e.PopBlocks={open:function(l){t('.popblocks-trigger[data-popblocks-id="'+l+'"]').modal("open")},close:function(){t(".popblocks-trigger").modal("close")}};let A=0,w=[],L=[];function y(l,s){return s==="element_class"?l="."+l:s==="element_id"&&(l="#"+l),t(l)}function h(l){let s=t(`[data-popblocks-id="${l}"]`).data("popblocks-data");if(s.options.active){let c=s.options.name;if(t.cookie("get",c))return!1}let d=!1;for(group of s.behaviors){let c=!0;for(rule of group.rules){let u=!1;if(rule.type==="browser_language")rule.operator==="equals"?u=i.toLowerCase()===rule.value.toLowerCase():u=i.toLowerCase()!==rule.value.toLowerCase();else if(rule.type==="url"){let m=e.location.href;rule.operator==="contains"?u=m.includes(rule.value.toLowerCase()):u=!m.includes(rule.value.toLowerCase())}else u=!0;if(console.log("rule",rule,u),!u){c=!1;break}}if(console.log("group",group,c),c){d=!0;break}}return console.log("pass",d),d}function K(l,s){let r=parseInt(s.rules[0].value,10);console.log("Page Load: ",s.rules[0].value,r),setTimeout(function(){h(l)&&PopBlocks.open(l)},r*1e3)}function Z(l,s){let r=0,d=s.rules[0].value,c;console.log(s.rules[0]),t(document).ready(function(){c=setInterval(u,1e3),t(this).mousemove(function(m){r=0}),t(this).keypress(function(m){r=0})});function u(){r++,r>d&&(h(l)&&PopBlocks.open(l),clearInterval(c))}}function X(l,s){let r=t(e),d=t("body"),c;d.on("mouseleave",u=>{c=u.clientY,c<0&&(console.log("Exit Intent"),r.trigger("exitintent"))}),r.on("exitintent",()=>{h(l)&&PopBlocks.open(l)})}function $(l,s){let r=s.rules[0].value.trim(),d=s.rules[0].operator;y(r,d).on("click",u=>{h(l)&&PopBlocks.open(l)})}function ee(l,s){let r=s.rules[0].value.trim(),d=s.rules[0].operator;y(r,d).on("mouseover",u=>{h(l)&&PopBlocks.open(l)})}function te(l,s){L.push({id:l,selector:s.rules[0].value.trim(),operator:s.rules[0].operator,opened:!1}),e.requestAnimationFrame(M)}function oe(l,s){w.push({id:l,percent:parseInt(s.rules[0].value,10),opened:!1}),e.requestAnimationFrame(M)}function M(){let l=!1;t.each(w,(s,r)=>{!r.opened&&A>=r.percent?(h(id)&&PopBlocks.open(r.id),r.opened=!0):l=!0}),t.each(L,(s,r)=>{if(r.opened)l=!0;else{let d=y(r.selector,r.operator);ie(d[0])?(h(id)&&PopBlocks.open(r.id),r.opened=!0):l=!0}}),l&&e.requestAnimationFrame(M)}function ie(l){let s=l.getBoundingClientRect();return s.top>=0&&s.left>=0&&s.bottom<=(e.innerHeight||document.documentElement.clientHeight)&&s.right<=(e.innerWidth||document.documentElement.clientWidth)}function le(l,s){return l*({months:730,weeks:168,days:24,hours:1}[s]||1)}t(document).ready(function(){let l={page_load:K,idle_time:Z,exit_intent:X,click:$,hover:ee,element_visibility:te,scroll:oe},s=t(".popblocks-trigger");console.log(s),s.modal({returnFocus:!1}),s.each((d,c)=>{let u=t(c),m=u.data("popblocks-id"),b=u.data("popblocks-data"),S=b.options.active,ue=b.options.name;r(m,b.triggers)});function r(d,c){t.each(c,(u,m)=>{let b=m.rules?.[0]?.type,S=l[b];S&&S(d,m)})}}),t(e).on("scroll",function(){let l=t(e).scrollTop(),s=t(document).height()-e.innerHeight;A=l/s*100}),t(e).on("modal:open",l=>{let s=t(l.originalEvent.detail.el).data("popblocks-data");console.log("open",s);let r=s.options.active;if(r){let d=s.options.name,c=s.options.duration,u=le(c.value,c.unit);t.cookie("set",d,!0,{path:"/",expires:1e3*60*60*u}),console.log(r,t.cookie("get",d))}})})(jQuery,window);})();
//# sourceMappingURL=popup.js.map
