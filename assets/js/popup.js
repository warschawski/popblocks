(()=>{function k(t){return typeof t}function y(t){return Object.prototype.toString.call(t)}function q(t){return te(t)||t===!1||t===null}function T(t){return k(t)==="function"}function I(t){return k(t)==="object"}function te(t){return k(t)==="undefined"}function g(...t){let e={},o=!1,l=0;k(t[0])==="boolean"&&(o=t[0],l++);let s=n=>{for(let f in n)Object.hasOwn(n,f)&&(o&&y(n[f])==="[object Object]"?e[f]=g(e[f],n[f]):e[f]=n[f])};for(;l<t.length;l++)s(t[l]);return e}function v(t,e){return(e||document).querySelectorAll(t)}function B(t){return[...t.parentElement.children].filter(e=>e!=t)}function oe(t){return["[object NodeList]","[object Array]"].includes(y(t))||(t=[t]),[...t].filter(e=>!q(e))}function p(t,e){oe(t).forEach(e)}function x(t,e,o,l){p(t,s=>{s.addEventListener(e,o,l||null)})}function z(t,e,o,l){x(t,e,o,g({once:!0,capture:l===!0},I(l)?l:{}))}function b(t,e,o){p(t,l=>{l.removeEventListener(e,o)})}function S(t,e,o){p(t,l=>{l.dispatchEvent(new CustomEvent(e,{detail:o||null}))})}function N(...t){return y(t[0])==="[object Array]"&&(t=t[0]),t=t.filter(e=>e!==""),t}function F(t,e){return t.classList.contains(e)}function C(t,...e){e=N(...e),p(t,o=>{o.classList.add(...e)})}function H(t,...e){e=N(...e),p(t,o=>{o.classList.remove(...e)})}function le(t,e){return t.getAttribute(e)}function ie(t,e){if(y(t)!=="[object Object]"){let o={};o[`${t}`]=e,t=o}return Object.entries(t)}function R(t,e,o){e=ie(e,o),p(t,l=>{for(let[s,n]of e)q(n)?re(t,s):l.setAttribute(s,n)})}function re(t,e){y(e)!=="[object Array]"&&(e=[e]),p(t,o=>{p(e,l=>{o.removeAttribute(l)})})}function J(t,e,o,l){let s=V([l,e].join("-"));p(t,n=>{n.dataset[s]=le(n,e)||"",R(n,e,o)})}function U(t,e,o){let l=V([o,e].join("-"));p(t,s=>{R(s,e,s.dataset[l]||!1),delete s.dataset[l]})}function V(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,o)=>o.toUpperCase())}var A,_=class t{static#e=1;static#t={customClass:"",returnFocus:!0,templates:{container:`
<div class="popblocks-modal" role="dialog" aria-modal="true">
  <div class="popblocks-modal-overlay"></div>
  <div class="popblocks-modal-container">
    <div class="popblocks-modal-wrap">
      <button type="button" class="popblocks-modal-close" aria-label="Close">[close]</button>
      <div class="popblocks-modal-frame"></div>
    </div>
  </div>
</div>`,close:'<span class="popblocks-modal-sr">Close</span><svg viewBox="-6 -6 24 24" fill="currentColor"><path d="M7.314 5.9l3.535-3.536A1 1 0 1 0 9.435.95L5.899 4.485 2.364.95A1 1 0 1 0 .95 2.364l3.535 3.535L.95 9.435a1 1 0 1 0 1.414 1.414l3.535-3.535 3.536 3.535a1 1 0 1 0 1.414-1.414L7.314 5.899z"></path></svg>'}};static defaults(e){this.#t=g(!0,this.#t,e)}static construct(e,o){let l=v(e);return p(l,s=>{s.Modal||new t(s,o)}),l}constructor(e,o){if(e.Modal){console.warn("Modal: Instance already exists",e);return}let l={},s=e.dataset;try{l=JSON.parse(s.popblocksOptions||"{}")}catch{console.warn("Modal: Error parsing options JSON",e)}Object.assign(this,g(!0,this.constructor.#t,o||{},l)),this.el=e,this.guid=this.constructor.#e++,this.guidClass=`popblocks-modal-element-${this.guid}`,this.isOpen=!1,C(this.el,this.guidClass),x(this.el,"click",this.#o),e.Modal=this}destroy(){this.close(),H(this.el,this.guidClass),b(this.el,"click",this.#o),this.el.Modal=null,delete this.el.Modal}open(){if(this.isOpen)return;let e;A?e=A.close():e=new Promise((o,l)=>{o(this.el)}),e.then(()=>{this.hash=this.el.hash,this.targetEl=v(this.hash)[0],this.targetEl&&(this.listeners={close:this.#a(),container:this.#s(),keydown:this.#c()},this.#l(),this.#i(),setTimeout(()=>{C(this.modalEl,"popblocks-modal-open"),this.isOpen=!0,this.closeEl.focus(),A=this,S(window,"modal:open",{el:this.el})},10))})}close(){return this.isOpen?(H(this.modalEl,"popblocks-modal-open"),this.#r(),b(window,"keydown",this.listeners.keydown),b(window,"modal:close",this.listeners.close),new Promise((o,l)=>{let s=n=>{F(n.target,"popblocks-modal")&&(this.targetEl.append(...this.frameEl.childNodes),b(this.modalEl,"transitionend",s),this.modalEl.remove(),this.isOpen=!1,this.returnFocus&&this.el.focus(),S(window,"modal:close",{el:this.el}),A=null,o(this.el))};x(this.modalEl,"transitionend",s)})):void 0}#l(){let e=this.templates.container.replace("[close]",this.templates.close);document.body.insertAdjacentHTML("beforeend",e),this.modalEl=v(".popblocks-modal")[0],this.overlayEl=v(".popblocks-modal-overlay",this.modalEl)[0],this.closeEl=v(".popblocks-modal-close",this.modalEl)[0],this.containerEl=v(".popblocks-modal-container",this.modalEl)[0],this.wrapEl=v(".popblocks-modal-wrap",this.modalEl)[0],this.frameEl=v(".popblocks-modal-frame",this.modalEl)[0],this.frameEl.append(...this.targetEl.childNodes),this.wrapEl.append(this.frameEl),C(this.modalEl,this.customClass),z(this.closeEl,"click",this.listeners.close),x(this.containerEl,"click",this.listeners.container),x(window,"keydown",this.listeners.keydown),x(window,"modal:close",this.listeners.close)}#i(){J(B(this.modalEl),"aria-hidden","true","modal")}#r(){U(B(this.modalEl),"aria-hidden","modal")}#o(e){e.preventDefault(),e.stopPropagation(),this.Modal.open()}#s(){return e=>{e.target!==this.frameEl&&!this.frameEl.contains(e.target)?this.close():this.#n(e)}}#n(e){F(e.target,"popblocks-modal-trigger-close")&&this.close()}#a(){return e=>{this.close()}}#c(){return e=>{e.key==="Escape"&&this.close()}}},D=_;function W(t,e){typeof jQuery<"u"&&(jQuery.fn[e.toLowerCase()]=function(o,...l){return jQuery(this).each((s,n)=>{!o||I(o)?new t(n,o):n[e]&&T(n[e][o])&&n[e][o](...l)})})}function w(t,e){typeof jQuery<"u"&&(jQuery[e.toLowerCase()]=function(o,...l){if(T(t[o]))return t[o](...l)})}W(D,"Modal");w(D,"Modal");var $=class{static#e={domain:null,expires:6048e5,path:null,samesite:"Lax",secure:null};static defaults(e){this.#e=g(!0,this.#e,e)}static set(e,o,l){let s=!1,n=new Date;l=g(!0,this.#e,l||{}),k(l.expires)==="number"&&(n.setTime(n.getTime()+l.expires),s=n.toGMTString());let f=l.domain?"; domain="+l.domain:"",h=s?"; expires="+s:"",L=s?"; max-age="+l.expires/1e3:"",j=l.path?"; path="+l.path:"",O=l.samesite?"; samesite="+l.samesite:"",M=l.secure?"; secure":"";document.cookie=`${e}=${o}${h}${L}${f}${j}${O}${M}`}static get(e){let o=`${e}=`,l=document.cookie.split(";");for(var s=0;s<l.length;s++){let n=l[s].trim();if(n.indexOf(o)===0)return n.substring(o.length,n.length)}return null}static delete(e,o){this.set(e,"",g({},o,{expires:-6048e5}))}},Y=$;w(Y,"Cookie");(function(t,e){let o=navigator.language.split("-")[0];e.PopBlocks={open:function(i){t('.popblocks-trigger[data-popblocks-id="'+i+'"]').modal("open")},close:function(){t(".popblocks-trigger").modal("close")}};let l=0,s=[],n=[];function f(i,r){return r==="element_class"?i="."+i:r==="element_id"&&(i="#"+i),t(i)}function h(i){let r=t(`[data-popblocks-id="${i}"]`).data("popblocks-data");if(r.options.active){let u=r.options.name;if(t.cookie("get",u))return!1}let d=!1;for(group of r.behaviors){let u=!0;for(rule of group.rules){let c=!1;if(rule.type==="browser_language")rule.operator==="equals"?c=o.toLowerCase()===rule.value.toLowerCase():c=o.toLowerCase()!==rule.value.toLowerCase();else if(rule.type==="url"){let m=e.location.href;rule.operator==="contains"?c=m.includes(rule.value.toLowerCase()):c=!m.includes(rule.value.toLowerCase())}else c=!0;if(console.log("rule",rule,c),!c){u=!1;break}}if(console.log("group",group,u),u){d=!0;break}}return console.log("pass",d),d}function L(i,r){let a=parseInt(r.rules[0].value,10);console.log("Page Load: ",r.rules[0].value,a),setTimeout(function(){h(i)&&PopBlocks.open(i)},a*1e3)}function j(i,r){let a=0,d=r.rules[0].value,u;console.log(r.rules[0]);let c=function(E){a=0};t(document).ready(function(){t(this).on(`mousemove.${i} keypress.${i}`,c),u=setInterval(m,1e3)});function m(){a++,a>d&&(h(i)&&PopBlocks.open(i),t(this).off(`mousemove.${i} keypress.${i}`,c),clearInterval(u))}}function O(i,r){let a=t(e),d=t("body"),u;d.on(`mouseleave.${i}`,c=>{u=c.clientY,u<0&&a.trigger(`exitintent.${i}`)}),a.on(`exitintent.${i}`,()=>{h(i)&&PopBlocks.open(i)})}function M(i,r){let a=r.rules[0].value.trim(),d=r.rules[0].operator;f(a,d).on(`click.${i}`,c=>{h(i)&&PopBlocks.open(i)})}function G(i,r){let a=r.rules[0].value.trim(),d=r.rules[0].operator;f(a,d).on(`mouseover.${i}`,c=>{h(i)&&PopBlocks.open(i)})}function K(i,r){n.push({id:i,selector:r.rules[0].value.trim(),operator:r.rules[0].operator,opened:!1}),e.requestAnimationFrame(P)}function Z(i,r){s.push({id:i,percent:parseInt(r.rules[0].value,10),opened:!1}),e.requestAnimationFrame(P)}function P(){let i=!1;t.each(s,(r,a)=>{!a.opened&&l>=a.percent?(h(id)&&PopBlocks.open(a.id),a.opened=!0):i=!0}),t.each(n,(r,a)=>{if(a.opened)i=!0;else{let d=f(a.selector,a.operator);X(d[0])?(h(id)&&PopBlocks.open(a.id),a.opened=!0):i=!0}}),i&&e.requestAnimationFrame(P)}function X(i){let r=i.getBoundingClientRect();return r.top>=0&&r.left>=0&&r.bottom<=(e.innerHeight||document.documentElement.clientHeight)&&r.right<=(e.innerWidth||document.documentElement.clientWidth)}function ee(i,r){return i*({months:730,weeks:168,days:24,hours:1}[r]||1)}t(document).ready(function(){let i={page_load:L,idle_time:j,exit_intent:O,click:M,hover:G,element_visibility:K,scroll:Z},r=t(".popblocks-trigger");console.log(r),r.modal({returnFocus:!1}),r.each((d,u)=>{let c=t(u),m=c.data("popblocks-id"),E=c.data("popblocks-data");a(m,E.triggers)});function a(d,u){t.each(u,(c,m)=>{let E=m.rules?.[0]?.type,Q=i[E];Q&&Q(d,m)})}}),t(e).on("scroll",function(){let i=t(e).scrollTop(),r=t(document).height()-e.innerHeight;l=i/r*100}),t(e).on("modal:open",i=>{let r=t(i.originalEvent.detail.el).data("popblocks-data");console.log("open",r);let a=r.options.active;if(a){let d=r.options.name,u=r.options.duration,c=ee(u.value,u.unit);t.cookie("set",d,!0,{path:"/",expires:1e3*60*60*c}),console.log(a,t.cookie("get",d))}})})(jQuery,window);})();
//# sourceMappingURL=popup.js.map
