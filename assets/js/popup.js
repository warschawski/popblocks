(()=>{function y(t){return typeof t}function E(t){return Object.prototype.toString.call(t)}function Q(t){return le(t)||t===!1||t===null}function S(t){return y(t)==="function"}function I(t){return y(t)==="object"}function le(t){return y(t)==="undefined"}function g(...t){let e={},i=!1,o=0;y(t[0])==="boolean"&&(i=t[0],o++);let r=a=>{for(let p in a)Object.hasOwn(a,p)&&(i&&E(a[p])==="[object Object]"?e[p]=g(e[p],a[p]):e[p]=a[p])};for(;o<t.length;o++)r(t[o]);return e}function k(t,e){return(e||document).querySelectorAll(t)}function T(t){return[...t.parentElement.children].filter(e=>e!=t)}function ne(t){return["[object NodeList]","[object Array]"].includes(E(t))||(t=[t]),[...t].filter(e=>!Q(e))}function f(t,e){ne(t).forEach(e)}function x(t,e,i,o){f(t,r=>{r.addEventListener(e,i,o||null)})}function q(t,e,i,o){x(t,e,i,g({once:!0,capture:o===!0},I(o)?o:{}))}function C(t,e,i){f(t,o=>{o.removeEventListener(e,i)})}function B(t,e,i){f(t,o=>{o.dispatchEvent(new CustomEvent(e,{detail:i||null}))})}function J(...t){return E(t[0])==="[object Array]"&&(t=t[0]),t=t.filter(e=>e!==""),t}function H(t,e){return t.classList.contains(e)}function O(t,...e){e=J(...e),f(t,i=>{i.classList.add(...e)})}function _(t,...e){e=J(...e),f(t,i=>{i.classList.remove(...e)})}function se(t,e){return t.getAttribute(e)}function re(t,e){if(E(t)!=="[object Object]"){let i={};i[`${t}`]=e,t=i}return Object.entries(t)}function z(t,e,i){e=re(e,i),f(t,o=>{for(let[r,a]of e)Q(a)?ae(t,r):o.setAttribute(r,a)})}function ae(t,e){E(e)!=="[object Array]"&&(e=[e]),f(t,i=>{f(e,o=>{i.removeAttribute(o)})})}function G(t,e,i,o){let r=U([o,e].join("-"));f(t,a=>{a.dataset[r]=se(a,e)||"",z(a,e,i)})}function R(t,e,i){let o=U([i,e].join("-"));f(t,r=>{z(r,e,r.dataset[o]||!1),delete r.dataset[o]})}function U(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,i)=>i.toUpperCase())}var D=class t{static#e=1;static#t={customClass:"",templates:{container:`
<div class="popblocks-modal" role="dialog" aria-modal="true">
  <div class="popblocks-modal-overlay"></div>
  <div class="popblocks-modal-container">
    <div class="popblocks-modal-wrap">
      <button type="button" class="popblocks-modal-close" aria-label="Close">[close]</button>
      <div class="popblocks-modal-frame"></div>
    </div>
  </div>
</div>`,close:'<span class="popblocks-modal-sr">Close</span><svg viewBox="-6 -6 24 24" fill="currentColor"><path d="M7.314 5.9l3.535-3.536A1 1 0 1 0 9.435.95L5.899 4.485 2.364.95A1 1 0 1 0 .95 2.364l3.535 3.535L.95 9.435a1 1 0 1 0 1.414 1.414l3.535-3.535 3.536 3.535a1 1 0 1 0 1.414-1.414L7.314 5.899z"></path></svg>'}};static defaults(e){this.#t=g(!0,this.#t,e)}static construct(e,i){let o=k(e);return f(o,r=>{r.Modal||new t(r,i)}),o}constructor(e,i){if(e.Modal){console.warn("Modal: Instance already exists",e);return}let o={},r=e.dataset;try{o=JSON.parse(r.popblocksOptions||"{}")}catch{console.warn("Modal: Error parsing options JSON",e)}Object.assign(this,g(!0,this.constructor.#t,i||{},o)),this.el=e,this.guid=this.constructor.#e++,this.guidClass=`popblocks-modal-element-${this.guid}`,this.isOpen=!1,O(this.el,this.guidClass),x(this.el,"click",this.#o),e.Modal=this}destroy(){this.close(),_(this.el,this.guidClass),C(this.el,"click",this.#o),this.el.Modal=null,delete this.el.Modal}open(){this.isOpen||(this.hash=this.el.hash,this.targetEl=k(this.hash)[0],this.targetEl&&(this.listeners={close:this.#a(),container:this.#s(),keydown:this.#c()},this.#i(),this.#l(),setTimeout(()=>{O(this.modalEl,"popblocks-modal-open"),this.isOpen=!0,this.closeEl.focus(),B(window,"modal:open",{el:this.el})},10)))}close(){if(!this.isOpen)return;_(this.modalEl,"popblocks-modal-open"),this.#n(),C(window,"keydown",this.listeners.keydown),C(window,"modal:close",this.listeners.close);let e=i=>{H(i.target,"popblocks-modal")&&(this.targetEl.append(...this.frameEl.childNodes),C(this.modalEl,"transitionend",e),this.modalEl.remove(),this.isOpen=!1,this.el.focus(),B(window,"modal:close",{el:this.el}))};x(this.modalEl,"transitionend",e)}#i(){let e=this.templates.container.replace("[close]",this.templates.close);document.body.insertAdjacentHTML("beforeend",e),this.modalEl=k(".popblocks-modal")[0],this.overlayEl=k(".popblocks-modal-overlay",this.modalEl)[0],this.closeEl=k(".popblocks-modal-close",this.modalEl)[0],this.containerEl=k(".popblocks-modal-container",this.modalEl)[0],this.wrapEl=k(".popblocks-modal-wrap",this.modalEl)[0],this.frameEl=k(".popblocks-modal-frame",this.modalEl)[0],this.frameEl.append(...this.targetEl.childNodes),this.wrapEl.append(this.frameEl),O(this.modalEl,this.customClass),q(this.closeEl,"click",this.listeners.close),x(this.containerEl,"click",this.listeners.container),x(window,"keydown",this.listeners.keydown),x(window,"modal:close",this.listeners.close)}#l(){G(T(this.modalEl),"aria-hidden","true","modal")}#n(){R(T(this.modalEl),"aria-hidden","modal")}#o(e){e.preventDefault(),e.stopPropagation(),this.Modal.open()}#s(){return e=>{e.target!==this.frameEl&&!this.frameEl.contains(e.target)?this.close():this.#r(e)}}#r(e){H(e.target,"popblocks-modal-trigger-close")&&this.close()}#a(){return e=>{this.close()}}#c(){return e=>{e.key==="Escape"&&this.close()}}},F=D;function V(t,e){typeof jQuery<"u"&&(jQuery.fn[e.toLowerCase()]=function(i,...o){return jQuery(this).each((r,a)=>{!i||I(i)?new t(a,i):a[e]&&S(a[e][i])&&a[e][i](...o)})})}function j(t,e){typeof jQuery<"u"&&(jQuery[e.toLowerCase()]=function(i,...o){if(S(t[i]))return t[i](...o)})}V(F,"Modal");j(F,"Modal");var N=class{static#e={domain:null,expires:6048e5,path:null,samesite:"Lax",secure:null};static defaults(e){this.#e=g(!0,this.#e,e)}static set(e,i,o){let r=!1,a=new Date;o=g(!0,this.#e,o||{}),y(o.expires)==="number"&&(a.setTime(a.getTime()+o.expires),r=a.toGMTString());let p=o.domain?"; domain="+o.domain:"",A=r?"; expires="+r:"",w=r?"; max-age="+o.expires/1e3:"",L=o.path?"; path="+o.path:"",b=o.samesite?"; samesite="+o.samesite:"",m=o.secure?"; secure":"";document.cookie=`${e}=${i}${A}${w}${p}${L}${b}${m}`}static get(e){let i=`${e}=`,o=document.cookie.split(";");for(var r=0;r<o.length;r++){let a=o[r].trim();if(a.indexOf(i)===0)return a.substring(i.length,a.length)}return null}static delete(e,i){this.set(e,"",g({},i,{expires:-6048e5}))}},W=N;j(W,"Cookie");(function(t,e){let i=navigator.language.split("-")[0];if(!navigator.geolocation)return;let o=null,r=e.sessionStorage.getItem("user-community-spotlight"),a=t.cookie("get","user-geo");try{r=JSON.parse(e.atob(r))}catch{}try{o=JSON.parse(a)}catch{}o?console.log(o):(console.log("Popblocks: Get Geo"),navigator.geolocation.getCurrentPosition(p));function p(l){console.log(l);let n={lat:l.coords.latitude,lng:l.coords.longitude};t.cookie("set","user-geo",JSON.stringify(n),{path:"/",expires:1e3*60*60*24})}e.PopBlocks={open:function(l){t('.popblocks-trigger[data-popblocks-id="'+l+'"]').modal("open")},close:function(){t(".popblocks-trigger").modal("close")}};let A=0,w=[],L=[];function b(l,n){return n==="element_class"?l="."+l:n==="element_id"&&(l="#"+l),t(l)}function m(l){let n=t(`[data-popblocks-id="${l}"]`).data("popblocks-data");if(n.options.active){let c=n.options.name;if(t.cookie("get",c))return!1}let d=!1;for(group of n.behaviors){let c=!0;for(rule of group.rules){let u=!1;if(rule.type==="browser_language")rule.operator==="equals"?u=i.toLowerCase()===rule.value.toLowerCase():u=i.toLowerCase()!==rule.value.toLowerCase();else if(rule.type==="url"){let h=e.location.href;rule.operator==="contains"?u=h.includes(rule.value.toLowerCase()):u=!h.includes(rule.value.toLowerCase())}else u=!0;if(console.log("rule",rule,u),!u){c=!1;break}}if(console.log("group",group,c),c){d=!0;break}}return console.log("pass",d),d}function Y(l,n){let s=parseInt(n.rules[0].value,10);console.log("Page Load: ",n.rules[0].value,s),setTimeout(function(){m(l)&&PopBlocks.open(l)},s*1e3)}function K(l,n){let s=0,d=n.rules[0].value,c;console.log(n.rules[0]),t(document).ready(function(){c=setInterval(u,1e3),t(this).mousemove(function(h){s=0}),t(this).keypress(function(h){s=0})});function u(){s++,s>d&&(m(l)&&PopBlocks.open(l),clearInterval(c))}}function Z(l,n){let s=t(e),d=t("body"),c;d.on("mouseleave",u=>{c=u.clientY,c<0&&(console.log("Exit Intent"),s.trigger("exitintent"))}),s.on("exitintent",()=>{m(l)&&PopBlocks.open(l)})}function X(l,n){let s=n.rules[0].value.trim(),d=n.rules[0].operator;b(s,d).on("click",u=>{m(l)&&PopBlocks.open(l)})}function $(l,n){let s=n.rules[0].value.trim(),d=n.rules[0].operator;b(s,d).on("mouseover",u=>{m(l)&&PopBlocks.open(l)})}function ee(l,n){L.push({id:l,selector:n.rules[0].value.trim(),operator:n.rules[0].operator,opened:!1}),e.requestAnimationFrame(P)}function te(l,n){w.push({id:l,percent:parseInt(n.rules[0].value,10),opened:!1}),e.requestAnimationFrame(P)}function P(){let l=!1;t.each(w,(n,s)=>{!s.opened&&A>=s.percent?(m(id)&&PopBlocks.open(s.id),s.opened=!0):l=!0}),t.each(L,(n,s)=>{if(s.opened)l=!0;else{let d=b(s.selector,s.operator);oe(d[0])?(m(id)&&PopBlocks.open(s.id),s.opened=!0):l=!0}}),l&&e.requestAnimationFrame(P)}function oe(l){let n=l.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.bottom<=(e.innerHeight||document.documentElement.clientHeight)&&n.right<=(e.innerWidth||document.documentElement.clientWidth)}function ie(l,n){return l*({months:730,weeks:168,days:24,hours:1}[n]||1)}t(document).ready(function(){let l={page_load:Y,idle_time:K,exit_intent:Z,click:X,hover:$,element_visibility:ee,scroll:te},n=t(".popblocks-trigger");console.log(n),n.modal({returnFocus:!1}),n.each((d,c)=>{let u=t(c),h=u.data("popblocks-id"),v=u.data("popblocks-data");console.log(h,v),console.log("data",v);let M=v.options.active,ce=v.options.name;s(h,v.triggers)});function s(d,c){t.each(c,(u,h)=>{let v=h.rules?.[0]?.type,M=l[v];M&&M(d,h)})}}),t(e).on("scroll",function(){let l=t(e).scrollTop(),n=t(document).height()-e.innerHeight;A=l/n*100}),t(e).on("modal:open",l=>{let n=t(l.originalEvent.detail.el).data("popblocks-data");console.log("open",n);let s=n.options.active;if(s){let d=n.options.name,c=n.options.duration,u=ie(c.value,c.unit);t.cookie("set",d,!0,{path:"/",expires:1e3*60*60*u}),console.log(s,t.cookie("get",d))}})})(jQuery,window);})();
//# sourceMappingURL=popup.js.map
